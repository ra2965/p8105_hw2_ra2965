---
title: "p8105_hw2_ra2965"
output: github_document
---
#Problem 1

##Read and clean the Mr. Trash Wheel sheet:

```{r Problem1 trash wheel}
library(tidyverse)

trash_wheel = readxl::read_excel("/Users/anran/Desktop/DataScience/week4/hw2/data/Trash-Wheel-Collection-Totals-8-6-19.xlsx", sheet = "Mr. Trash Wheel") %>%
  janitor::clean_names() %>%
    select(-x15, -x16,-x17) %>%
    drop_na(dumpster) %>%
    mutate(sports_balls = as.integer(sports_balls))
```

## Read and clean precipitation data for 2017 and 2018:

```{r Problem1 precipitation}

precipitation_2018 = readxl::read_excel("/Users/anran/Desktop/DataScience/week4/hw2/data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",sheet = "2018 Precipitation", skip = 1) %>%
janitor::clean_names() %>%
drop_na(.) %>%
mutate(year = 2018)


precipitation_2017 = readxl::read_excel("/Users/anran/Desktop/DataScience/week4/hw2/data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",sheet = "2017 Precipitation",skip = 1) %>%
janitor::clean_names() %>%
drop_na(.) %>%
mutate(year = 2017)

precipitation = full_join(precipitation_2017, precipitation_2018) %>%
mutate(month = month.name[month])

```
There are `r nrow(trash_wheel)` observations and `r ncol(trash_wheel)` variables in the Mr. Trash Wheel dataset.

There are `r nrow(precipitation)` observations in the precipitation dataset. For available data, the total precipitation in 2018 is `r sum(pull(precipitation_2018, total))`. The median number of sports balls in a dumpster in 2017 is `r median(pull(trash_wheel%>% filter(year == 2017), sports_balls))`.

#Problem 2


```{r Problem2 pols-month}

pols = read_csv(file = "../data/fivethirtyeight_datasets/pols-month.csv") %>%
janitor::clean_names() %>%
separate(mon, into = c("year","month","day"), sep = "-", convert = TRUE) %>%
mutate(month = month.abb[month]) %>%
  mutate(president = ifelse(prez_gop > 0, "gop","dem")) %>%
  select(-prez_gop, -prez_dem, -day)

```

```{r Problem2 snp}

snp = read_csv(file = "../data/fivethirtyeight_datasets/snp.csv") %>%
separate("date", into = c("day","month","year"), sep = "/", convert = TRUE) %>%
  arrange(year, month)%>%
  mutate(month = month.abb[month])%>%
  select(year, month, everything(),-day)

```

```{r Problem2 unemployment}

unemployment = read_csv(file = "../data/fivethirtyeight_datasets/unemployment.csv") %>%
  pivot_longer(Jan:Dec,
             names_to = "month",
             values_to = "percent_unemployment"
) %>%
  select(year = Year, everything())

```

Join the datasetsï¼š

```{r joined datasets}

snp_pols = left_join(pols, snp, by = c("month","year"))
snp_pols_emp = left_join(snp_pols, unemployment, by = c("month","year"))

```

Write a short paragraph about these datasets. Explain briefly what each dataset contained, and describe the resulting dataset (e.g. give the dimension, range of years, and names of key variables).

`r min(pull(snp_pols_emp, year))` to `r max(pull(snp_pols_emp, year))` 

Note: we could have used a date variable as a key instead of creating year and month keys; doing so would help with some kinds of plotting, and be a more accurate representation of the data. Date formats are tricky, though. For more information check out the lubridate package in the tidyverse.

```{r Problem3 babynames}
baby_names = read_csv(file = "../data/Popular_Baby_Names.csv") %>%
  janitor::clean_names() %>%
  mutate(ethnicity = recode(ethnicity, "ASIAN AND PACI" = "ASIAN AND PACIFIC ISLANDER", "BLACK NON HISP"= "BLACK NON HISPANIC","WHITE NON HISP" = "WHITE NON HISPANIC"))%>%
  mutate(childs_first_name = str_to_lower(childs_first_name)) %>%
  distinct()

```

```{r female and male name}
baby_names %>% filter(childs_first_name == "olivia",gender == "FEMALE") %>% select(childs_first_name, year_of_birth,ethnicity, rank) %>%
  pivot_wider(names_from = "year_of_birth",
              values_from = "rank") %>% knitr::kable()


baby_names %>% filter(gender == "MALE",rank == 1) %>% select(childs_first_name, year_of_birth,ethnicity) %>% pivot_wider(names_from = "year_of_birth",
              values_from = "childs_first_name") %>% knitr::kable()
```


```{r}
library(ggridges)
plot_df = filter(baby_names, ethnicity == "WHITE NON HISPANIC", gender == "MALE", year_of_birth == 2016)
ggplot(plot_df, aes(x = rank, y = count)) + geom_point() +
  labs(
    title = "The first name of male, white non-hispanic children born in 2016",
    x = "The rank in popularity of that name (rank)",
    y = "The number of children with a name (count)")
  
```

